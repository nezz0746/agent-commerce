{"version":3,"sources":["../src/index.ts","../src/tools/read.ts","../src/types.ts","../src/subgraph.ts","../src/tools/write.ts","../src/abis/Shop.ts","../src/client.ts","../src/tools/admin.ts","../src/abis/CommerceHub.ts","../src/tools/erc8004.ts","../src/abis/IdentityRegistry.ts","../src/abis/ReputationRegistry.ts","../src/abis/ValidationRegistry.ts","../src/tools/escrow.ts"],"sourcesContent":["import { McpServer } from \"@modelcontextprotocol/sdk/server/mcp.js\";\nimport { StdioServerTransport } from \"@modelcontextprotocol/sdk/server/stdio.js\";\nimport { registerReadTools } from \"./tools/read.js\";\nimport { registerWriteTools } from \"./tools/write.js\";\nimport { registerAdminTools } from \"./tools/admin.js\";\nimport { registerERC8004Tools } from \"./tools/erc8004.js\";\nimport { registerEscrowTools } from \"./tools/escrow.js\";\n\nconst server = new McpServer({\n  name: \"onchain-commerce\",\n  version: \"0.1.0\",\n});\n\n// Register all tools\nregisterReadTools(server);\nregisterWriteTools(server);\nregisterAdminTools(server);\nregisterERC8004Tools(server);\nregisterEscrowTools(server);\n\n// Start the server with stdio transport\nconst transport = new StdioServerTransport();\nawait server.connect(transport);\n","import { McpServer } from \"@modelcontextprotocol/sdk/server/mcp.js\";\nimport { z } from \"zod\";\nimport * as subgraph from \"../subgraph.js\";\n\nexport function registerReadTools(server: McpServer) {\n  server.tool(\n    \"list_shops\",\n    \"List all shops on the Onchain Commerce protocol\",\n    {},\n    async () => {\n      const data = await subgraph.listShops();\n      return { content: [{ type: \"text\", text: JSON.stringify(data, null, 2) }] };\n    }\n  );\n\n  server.tool(\n    \"get_shop\",\n    \"Get detailed shop info including products, categories, collections, orders, and reviews\",\n    { shopAddress: z.string().describe(\"Shop contract address\") },\n    async ({ shopAddress }) => {\n      const data = await subgraph.getShop(shopAddress);\n      return { content: [{ type: \"text\", text: JSON.stringify(data, null, 2) }] };\n    }\n  );\n\n  server.tool(\n    \"get_product\",\n    \"Get product details with variants\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      productId: z.string().describe(\"Product ID\"),\n    },\n    async ({ shopAddress, productId }) => {\n      const data = await subgraph.getProduct(shopAddress, productId);\n      return { content: [{ type: \"text\", text: JSON.stringify(data, null, 2) }] };\n    }\n  );\n\n  server.tool(\n    \"get_orders\",\n    \"Get all orders for a customer address\",\n    { customerAddress: z.string().describe(\"Customer wallet address\") },\n    async ({ customerAddress }) => {\n      const data = await subgraph.getOrders(customerAddress);\n      return { content: [{ type: \"text\", text: JSON.stringify(data, null, 2) }] };\n    }\n  );\n\n  server.tool(\n    \"search_products\",\n    \"Search products by name across all shops\",\n    { query: z.string().describe(\"Search query for product name\") },\n    async ({ query }) => {\n      const data = await subgraph.searchProducts(query);\n      return { content: [{ type: \"text\", text: JSON.stringify(data, null, 2) }] };\n    }\n  );\n}\n","export const DEFAULTS = {\n  RPC_URL: \"https://sepolia.optimism.io\",\n  HUB_ADDRESS: \"0x479bcD43394867983d7dAE0b7280c251dFa0b935\" as `0x${string}`,\n  SUBGRAPH_URL:\n    \"https://api.studio.thegraph.com/query/958/onchain-commerce/v0.0.1\",\n  CHAIN_ID: 11155420,\n} as const;\n\nexport function getConfig() {\n  return {\n    rpcUrl: process.env.COMMERCE_RPC_URL || DEFAULTS.RPC_URL,\n    privateKey: process.env.COMMERCE_PRIVATE_KEY as `0x${string}` | undefined,\n    hubAddress: (process.env.COMMERCE_HUB_ADDRESS ||\n      DEFAULTS.HUB_ADDRESS) as `0x${string}`,\n    subgraphUrl:\n      process.env.COMMERCE_SUBGRAPH_URL || DEFAULTS.SUBGRAPH_URL,\n  };\n}\n","import { getConfig } from \"./types.js\";\n\nasync function query(q: string, variables?: Record<string, unknown>) {\n  const { subgraphUrl } = getConfig();\n  const res = await fetch(subgraphUrl, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ query: q, variables }),\n  });\n  const json = (await res.json()) as { data?: unknown; errors?: { message: string }[] };\n  if (json.errors) throw new Error(json.errors.map((e) => e.message).join(\", \"));\n  return json.data as Record<string, unknown>;\n}\n\nexport async function listShops() {\n  return query(`{\n    shops(first: 100) {\n      id address owner name metadataURI createdAt\n      products { id }\n      orders { id }\n    }\n  }`);\n}\n\nexport async function getShop(address: string) {\n  const id = address.toLowerCase();\n  return query(\n    `query($id: ID!) {\n      shop(id: $id) {\n        id address owner name metadataURI createdAt paymentSplitAddress\n        products(first: 100) {\n          id productId name price stock category { id name } metadataURI active\n          variants { id variantId name price stock active }\n        }\n        categories(first: 100) { id categoryId name metadataURI active }\n        collections(first: 100) { id collectionId name productIds metadataURI active }\n        orders(first: 100, orderBy: createdAt, orderDirection: desc) {\n          id orderId customer { address } totalAmount status createdAt\n          items { product { productId name } variant { variantId name } quantity }\n        }\n        reviews(first: 100) { id reviewId rating metadataURI createdAt customer { address } order { orderId } }\n        discounts(first: 100) { id discountId code basisPoints maxUses usedCount expiresAt active }\n      }\n    }`,\n    { id }\n  );\n}\n\nexport async function getProduct(shopAddress: string, productId: string) {\n  const id = `${shopAddress.toLowerCase()}-${productId}`;\n  return query(\n    `query($id: ID!) {\n      product(id: $id) {\n        id productId name price stock category { id name } metadataURI active createdAt\n        shop { address name }\n        variants { id variantId name price stock active }\n      }\n    }`,\n    { id }\n  );\n}\n\nexport async function getOrders(customerAddress: string) {\n  const id = customerAddress.toLowerCase();\n  return query(\n    `query($id: ID!) {\n      customer(id: $id) {\n        address\n        orders(first: 100, orderBy: createdAt, orderDirection: desc) {\n          id orderId shop { address name } totalAmount status createdAt\n          items { product { productId name } variant { variantId name } quantity }\n        }\n        reviews { id reviewId rating shop { address name } order { orderId } }\n      }\n    }`,\n    { id }\n  );\n}\n\nexport async function searchProducts(searchName: string) {\n  // The Graph supports name_contains_nocase for text search\n  return query(\n    `query($name: String!) {\n      products(first: 50, where: { name_contains_nocase: $name, active: true }) {\n        id productId name price stock metadataURI active\n        shop { address name }\n        category { name }\n        variants { variantId name price stock active }\n      }\n    }`,\n    { name: searchName }\n  );\n}\n\nexport async function getProductPrices(\n  shopAddress: string,\n  items: { productId: string; variantId: string }[]\n) {\n  // Fetch product and variant prices for order total calculation\n  const productIds = [...new Set(items.map((i) => `${shopAddress.toLowerCase()}-${i.productId}`))];\n  const data = await query(\n    `query($ids: [ID!]!) {\n      products(where: { id_in: $ids }) {\n        id productId price\n        variants { variantId price }\n      }\n    }`,\n    { ids: productIds }\n  );\n  return data.products as Array<{\n    productId: string;\n    price: string;\n    variants: Array<{ variantId: string; price: string }>;\n  }>;\n}\n","import { McpServer } from \"@modelcontextprotocol/sdk/server/mcp.js\";\nimport { z } from \"zod\";\nimport { parseEther, formatEther, decodeEventLog } from \"viem\";\nimport { shopAbi } from \"../abis/Shop.js\";\nimport { getPublicClient, getWalletClient, getAccount } from \"../client.js\";\nimport { getProductPrices } from \"../subgraph.js\";\n\nexport function registerWriteTools(server: McpServer) {\n  server.tool(\n    \"create_order\",\n    \"Purchase items from a shop. Calculates total price from product/variant prices and sends ETH.\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      items: z\n        .array(\n          z.object({\n            productId: z.string().describe(\"Product ID\"),\n            variantId: z.string().describe(\"Variant ID (use '0' for no variant)\"),\n            quantity: z.number().int().positive().describe(\"Quantity to purchase\"),\n          })\n        )\n        .describe(\"Array of items to purchase\"),\n    },\n    async ({ shopAddress, items }) => {\n      const publicClient = getPublicClient();\n      const walletClient = getWalletClient();\n      const account = getAccount();\n\n      // Fetch prices from subgraph\n      const products = await getProductPrices(shopAddress, items);\n\n      // Calculate total\n      let total = 0n;\n      for (const item of items) {\n        const product = products.find((p) => p.productId === item.productId);\n        if (!product) throw new Error(`Product ${item.productId} not found`);\n\n        let price: bigint;\n        if (item.variantId !== \"0\") {\n          const variant = product.variants.find(\n            (v) => v.variantId === item.variantId\n          );\n          if (!variant) throw new Error(`Variant ${item.variantId} not found for product ${item.productId}`);\n          price = BigInt(variant.price);\n        } else {\n          price = BigInt(product.price);\n        }\n        total += price * BigInt(item.quantity);\n      }\n\n      const orderItems = items.map((i) => ({\n        productId: BigInt(i.productId),\n        variantId: BigInt(i.variantId),\n        quantity: BigInt(i.quantity),\n      }));\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"createOrder\",\n        args: [orderItems],\n        value: total,\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      // Extract order ID from event\n      let orderId: string | undefined;\n      for (const log of receipt.logs) {\n        try {\n          const event = decodeEventLog({\n            abi: shopAbi,\n            data: log.data,\n            topics: log.topics,\n          });\n          if (event.eventName === \"OrderCreated\") {\n            orderId = (event.args as { orderId: bigint }).orderId.toString();\n          }\n        } catch {\n          // not our event\n        }\n      }\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify({\n              success: true,\n              txHash: hash,\n              orderId,\n              totalPaid: formatEther(total) + \" ETH\",\n              blockNumber: receipt.blockNumber.toString(),\n            }, null, 2),\n          },\n        ],\n      };\n    }\n  );\n\n  server.tool(\n    \"cancel_order\",\n    \"Cancel an order (if not yet fulfilled)\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      orderId: z.string().describe(\"Order ID to cancel\"),\n    },\n    async ({ shopAddress, orderId }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"cancelOrder\",\n        args: [BigInt(orderId)],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify({\n              success: true,\n              txHash: hash,\n              orderId,\n              blockNumber: receipt.blockNumber.toString(),\n            }, null, 2),\n          },\n        ],\n      };\n    }\n  );\n\n  server.tool(\n    \"leave_feedback\",\n    \"Leave feedback for a fulfilled order via ERC-8004 Reputation Registry\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      orderId: z.string().describe(\"Order ID to leave feedback for\"),\n      value: z.number().int().describe(\"Feedback value (e.g. 1-5)\"),\n      valueDecimals: z.number().int().default(0).describe(\"Decimal places for value\"),\n      tag1: z.string().default(\"quality\").describe(\"Feedback category (quality, delivery, accuracy)\"),\n      feedbackURI: z.string().default(\"\").describe(\"URI to detailed feedback\"),\n    },\n    async ({ shopAddress, orderId, value, valueDecimals, tag1, feedbackURI }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"leaveFeedback\",\n        args: [BigInt(orderId), BigInt(value), valueDecimals, tag1, feedbackURI],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify({\n              success: true,\n              txHash: hash,\n              orderId,\n              blockNumber: receipt.blockNumber.toString(),\n            }, null, 2),\n          },\n        ],\n      };\n    }\n  );\n}\n","export const shopAbi = [\n  {\n    type: \"function\",\n    name: \"createOrder\",\n    inputs: [\n      {\n        name: \"items\",\n        type: \"tuple[]\",\n        components: [\n          { name: \"productId\", type: \"uint256\" },\n          { name: \"variantId\", type: \"uint256\" },\n          { name: \"quantity\", type: \"uint256\" },\n        ],\n      },\n    ],\n    outputs: [{ name: \"orderId\", type: \"uint256\" }],\n    stateMutability: \"payable\",\n  },\n  {\n    type: \"function\",\n    name: \"cancelOrder\",\n    inputs: [{ name: \"orderId\", type: \"uint256\" }],\n    outputs: [],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"fulfillOrder\",\n    inputs: [{ name: \"orderId\", type: \"uint256\" }],\n    outputs: [],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"leaveReview\",\n    inputs: [\n      { name: \"orderId\", type: \"uint256\" },\n      { name: \"rating\", type: \"uint8\" },\n      { name: \"_metadataURI\", type: \"string\" },\n    ],\n    outputs: [{ name: \"reviewId\", type: \"uint256\" }],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"createProduct\",\n    inputs: [\n      { name: \"_name\", type: \"string\" },\n      { name: \"_price\", type: \"uint256\" },\n      { name: \"_stock\", type: \"uint256\" },\n      { name: \"_categoryId\", type: \"uint256\" },\n      { name: \"_metadataURI\", type: \"string\" },\n    ],\n    outputs: [{ name: \"productId\", type: \"uint256\" }],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"createCategory\",\n    inputs: [\n      { name: \"_name\", type: \"string\" },\n      { name: \"_metadataURI\", type: \"string\" },\n    ],\n    outputs: [{ name: \"categoryId\", type: \"uint256\" }],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"createDiscount\",\n    inputs: [\n      { name: \"code\", type: \"bytes32\" },\n      { name: \"basisPoints\", type: \"uint256\" },\n      { name: \"maxUses\", type: \"uint256\" },\n      { name: \"expiresAt\", type: \"uint256\" },\n    ],\n    outputs: [{ name: \"discountId\", type: \"uint256\" }],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"products\",\n    inputs: [{ name: \"\", type: \"uint256\" }],\n    outputs: [\n      { name: \"name\", type: \"string\" },\n      { name: \"price\", type: \"uint256\" },\n      { name: \"stock\", type: \"uint256\" },\n      { name: \"categoryId\", type: \"uint256\" },\n      { name: \"metadataURI\", type: \"string\" },\n      { name: \"active\", type: \"bool\" },\n    ],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"variants\",\n    inputs: [\n      { name: \"\", type: \"uint256\" },\n      { name: \"\", type: \"uint256\" },\n    ],\n    outputs: [\n      { name: \"name\", type: \"string\" },\n      { name: \"price\", type: \"uint256\" },\n      { name: \"stock\", type: \"uint256\" },\n      { name: \"active\", type: \"bool\" },\n    ],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"name\",\n    inputs: [],\n    outputs: [{ name: \"\", type: \"string\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"event\",\n    name: \"OrderCreated\",\n    inputs: [\n      { name: \"orderId\", type: \"uint256\", indexed: true },\n      { name: \"customer\", type: \"address\", indexed: true },\n      { name: \"totalAmount\", type: \"uint256\", indexed: false },\n    ],\n    anonymous: false,\n  },\n  {\n    type: \"event\",\n    name: \"OrderCancelled\",\n    inputs: [{ name: \"orderId\", type: \"uint256\", indexed: true }],\n    anonymous: false,\n  },\n  {\n    type: \"event\",\n    name: \"OrderFulfilled\",\n    inputs: [{ name: \"orderId\", type: \"uint256\", indexed: true }],\n    anonymous: false,\n  },\n  {\n    type: \"event\",\n    name: \"ReviewCreated\",\n    inputs: [\n      { name: \"reviewId\", type: \"uint256\", indexed: true },\n      { name: \"orderId\", type: \"uint256\", indexed: true },\n      { name: \"customer\", type: \"address\", indexed: true },\n      { name: \"rating\", type: \"uint8\", indexed: false },\n    ],\n    anonymous: false,\n  },\n  {\n    type: \"event\",\n    name: \"ProductCreated\",\n    inputs: [\n      { name: \"productId\", type: \"uint256\", indexed: true },\n      { name: \"name\", type: \"string\", indexed: false },\n      { name: \"price\", type: \"uint256\", indexed: false },\n      { name: \"stock\", type: \"uint256\", indexed: false },\n      { name: \"categoryId\", type: \"uint256\", indexed: false },\n    ],\n    anonymous: false,\n  },\n  {\n    type: \"event\",\n    name: \"CategoryCreated\",\n    inputs: [\n      { name: \"categoryId\", type: \"uint256\", indexed: true },\n      { name: \"name\", type: \"string\", indexed: false },\n    ],\n    anonymous: false,\n  },\n  {\n    type: \"event\",\n    name: \"DiscountCreated\",\n    inputs: [\n      { name: \"discountId\", type: \"uint256\", indexed: true },\n      { name: \"code\", type: \"bytes32\", indexed: false },\n      { name: \"basisPoints\", type: \"uint256\", indexed: false },\n      { name: \"maxUses\", type: \"uint256\", indexed: false },\n      { name: \"expiresAt\", type: \"uint256\", indexed: false },\n    ],\n    anonymous: false,\n  },\n  {\n    type: \"function\",\n    name: \"deliverDigital\",\n    inputs: [\n      { name: \"orderId\", type: \"uint256\" },\n      { name: \"payload\", type: \"bytes\" },\n    ],\n    outputs: [],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"getDelivery\",\n    inputs: [{ name: \"orderId\", type: \"uint256\" }],\n    outputs: [{ name: \"\", type: \"bytes\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"leaveFeedback\",\n    inputs: [\n      { name: \"orderId\", type: \"uint256\" },\n      { name: \"value\", type: \"int128\" },\n      { name: \"valueDecimals\", type: \"uint8\" },\n      { name: \"tag1\", type: \"string\" },\n      { name: \"feedbackURI\", type: \"string\" },\n    ],\n    outputs: [],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"event\",\n    name: \"DigitalDelivery\",\n    inputs: [\n      { name: \"orderId\", type: \"uint256\", indexed: true },\n      { name: \"payload\", type: \"bytes\", indexed: false },\n    ],\n  },\n  {\n    type: \"event\",\n    name: \"FeedbackLeft\",\n    inputs: [\n      { name: \"orderId\", type: \"uint256\", indexed: true },\n      { name: \"customer\", type: \"address\", indexed: true },\n      { name: \"agentId\", type: \"uint256\", indexed: true },\n      { name: \"value\", type: \"int128\", indexed: false },\n    ],\n  },\n  // Escrow\n  {\n    type: \"function\",\n    name: \"claimRefund\",\n    inputs: [{ name: \"orderId\", type: \"uint256\" }],\n    outputs: [],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"setEscrowTimeout\",\n    inputs: [{ name: \"_timeout\", type: \"uint256\" }],\n    outputs: [],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"escrowTimeout\",\n    inputs: [],\n    outputs: [{ name: \"\", type: \"uint256\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"orders\",\n    inputs: [{ name: \"\", type: \"uint256\" }],\n    outputs: [\n      { name: \"customer\", type: \"address\" },\n      { name: \"totalAmount\", type: \"uint256\" },\n      { name: \"protocolFeeAmount\", type: \"uint256\" },\n      { name: \"escrowAmount\", type: \"uint256\" },\n      { name: \"status\", type: \"uint8\" },\n      { name: \"createdAt\", type: \"uint256\" },\n      { name: \"shippingHash\", type: \"bytes32\" },\n    ],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"event\",\n    name: \"RefundClaimed\",\n    inputs: [\n      { name: \"orderId\", type: \"uint256\", indexed: true },\n      { name: \"customer\", type: \"address\", indexed: true },\n      { name: \"amount\", type: \"uint256\", indexed: false },\n    ],\n    anonymous: false,\n  },\n  {\n    type: \"event\",\n    name: \"EscrowTimeoutUpdated\",\n    inputs: [\n      { name: \"newTimeout\", type: \"uint256\", indexed: false },\n    ],\n    anonymous: false,\n  },\n] as const;\n","import {\n  createPublicClient,\n  createWalletClient,\n  http,\n  type PublicClient,\n  type WalletClient,\n  type Chain,\n} from \"viem\";\nimport { privateKeyToAccount } from \"viem/accounts\";\nimport { getConfig } from \"./types.js\";\n\nconst opSepolia: Chain = {\n  id: 11155420,\n  name: \"OP Sepolia\",\n  nativeCurrency: { name: \"Ether\", symbol: \"ETH\", decimals: 18 },\n  rpcUrls: {\n    default: { http: [\"https://sepolia.optimism.io\"] },\n  },\n  blockExplorers: {\n    default: { name: \"Blockscout\", url: \"https://optimism-sepolia.blockscout.com\" },\n  },\n  testnet: true,\n};\n\nlet _publicClient: PublicClient | null = null;\nlet _walletClient: WalletClient | null = null;\n\nexport function getPublicClient(): PublicClient {\n  if (!_publicClient) {\n    const { rpcUrl } = getConfig();\n    _publicClient = createPublicClient({\n      chain: opSepolia,\n      transport: http(rpcUrl),\n    });\n  }\n  return _publicClient;\n}\n\nexport function getWalletClient(): WalletClient {\n  if (!_walletClient) {\n    const { rpcUrl, privateKey } = getConfig();\n    if (!privateKey) {\n      throw new Error(\n        \"COMMERCE_PRIVATE_KEY env var is required for write operations\"\n      );\n    }\n    const account = privateKeyToAccount(privateKey);\n    _walletClient = createWalletClient({\n      chain: opSepolia,\n      transport: http(rpcUrl),\n      account,\n    });\n  }\n  return _walletClient;\n}\n\nexport function getAccount() {\n  const { privateKey } = getConfig();\n  if (!privateKey) {\n    throw new Error(\"COMMERCE_PRIVATE_KEY env var is required for write operations\");\n  }\n  return privateKeyToAccount(privateKey);\n}\n","import { McpServer } from \"@modelcontextprotocol/sdk/server/mcp.js\";\nimport { z } from \"zod\";\nimport { decodeEventLog, parseEther, stringToHex, padHex } from \"viem\";\nimport { shopAbi } from \"../abis/Shop.js\";\nimport { commerceHubAbi } from \"../abis/CommerceHub.js\";\nimport { getPublicClient, getWalletClient, getAccount } from \"../client.js\";\nimport { getConfig } from \"../types.js\";\n\nexport function registerAdminTools(server: McpServer) {\n  server.tool(\n    \"create_shop\",\n    \"Create a new shop via the CommerceHub\",\n    {\n      name: z.string().describe(\"Shop name\"),\n      metadataURI: z.string().describe(\"Metadata URI for the shop\"),\n    },\n    async ({ name, metadataURI }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n      const { hubAddress } = getConfig();\n\n      const hash = await walletClient.writeContract({\n        address: hubAddress,\n        abi: commerceHubAbi,\n        functionName: \"createShop\",\n        args: [name, metadataURI],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      let shopAddress: string | undefined;\n      for (const log of receipt.logs) {\n        try {\n          const event = decodeEventLog({\n            abi: commerceHubAbi,\n            data: log.data,\n            topics: log.topics,\n          });\n          if (event.eventName === \"ShopCreated\") {\n            shopAddress = (event.args as { shop: string }).shop;\n          }\n        } catch {\n          // not our event\n        }\n      }\n\n      return {\n        content: [{\n          type: \"text\",\n          text: JSON.stringify({ success: true, txHash: hash, shopAddress, blockNumber: receipt.blockNumber.toString() }, null, 2),\n        }],\n      };\n    }\n  );\n\n  server.tool(\n    \"create_product\",\n    \"Add a product to a shop\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      name: z.string().describe(\"Product name\"),\n      priceEth: z.string().describe(\"Price in ETH (e.g. '0.01')\"),\n      stock: z.number().int().nonnegative().describe(\"Initial stock\"),\n      categoryId: z.string().default(\"0\").describe(\"Category ID (0 for uncategorized)\"),\n      metadataURI: z.string().default(\"\").describe(\"Metadata URI\"),\n    },\n    async ({ shopAddress, name, priceEth, stock, categoryId, metadataURI }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"createProduct\",\n        args: [name, parseEther(priceEth), BigInt(stock), BigInt(categoryId), metadataURI],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      let productId: string | undefined;\n      for (const log of receipt.logs) {\n        try {\n          const event = decodeEventLog({ abi: shopAbi, data: log.data, topics: log.topics });\n          if (event.eventName === \"ProductCreated\") {\n            productId = (event.args as { productId: bigint }).productId.toString();\n          }\n        } catch {}\n      }\n\n      return {\n        content: [{\n          type: \"text\",\n          text: JSON.stringify({ success: true, txHash: hash, productId, blockNumber: receipt.blockNumber.toString() }, null, 2),\n        }],\n      };\n    }\n  );\n\n  server.tool(\n    \"create_category\",\n    \"Add a category to a shop\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      name: z.string().describe(\"Category name\"),\n      metadataURI: z.string().default(\"\").describe(\"Metadata URI\"),\n    },\n    async ({ shopAddress, name, metadataURI }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"createCategory\",\n        args: [name, metadataURI],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      let categoryId: string | undefined;\n      for (const log of receipt.logs) {\n        try {\n          const event = decodeEventLog({ abi: shopAbi, data: log.data, topics: log.topics });\n          if (event.eventName === \"CategoryCreated\") {\n            categoryId = (event.args as { categoryId: bigint }).categoryId.toString();\n          }\n        } catch {}\n      }\n\n      return {\n        content: [{\n          type: \"text\",\n          text: JSON.stringify({ success: true, txHash: hash, categoryId, blockNumber: receipt.blockNumber.toString() }, null, 2),\n        }],\n      };\n    }\n  );\n\n  server.tool(\n    \"fulfill_order\",\n    \"Mark an order as fulfilled (shop owner/manager only)\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      orderId: z.string().describe(\"Order ID to fulfill\"),\n    },\n    async ({ shopAddress, orderId }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"fulfillOrder\",\n        args: [BigInt(orderId)],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      return {\n        content: [{\n          type: \"text\",\n          text: JSON.stringify({ success: true, txHash: hash, orderId, blockNumber: receipt.blockNumber.toString() }, null, 2),\n        }],\n      };\n    }\n  );\n\n  server.tool(\n    \"create_discount\",\n    \"Create a discount code for a shop\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      code: z.string().describe(\"Discount code string\"),\n      basisPoints: z.number().int().min(1).max(10000).describe(\"Discount in basis points (100 = 1%)\"),\n      maxUses: z.number().int().positive().describe(\"Maximum number of uses\"),\n      expiresAt: z.number().int().describe(\"Expiry timestamp (unix seconds, 0 for no expiry)\"),\n    },\n    async ({ shopAddress, code, basisPoints, maxUses, expiresAt }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n\n      // Convert code string to bytes32\n      const codeHex = stringToHex(code, { size: 32 });\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"createDiscount\",\n        args: [codeHex, BigInt(basisPoints), BigInt(maxUses), BigInt(expiresAt)],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      let discountId: string | undefined;\n      for (const log of receipt.logs) {\n        try {\n          const event = decodeEventLog({ abi: shopAbi, data: log.data, topics: log.topics });\n          if (event.eventName === \"DiscountCreated\") {\n            discountId = (event.args as { discountId: bigint }).discountId.toString();\n          }\n        } catch {}\n      }\n\n      return {\n        content: [{\n          type: \"text\",\n          text: JSON.stringify({ success: true, txHash: hash, discountId, code, blockNumber: receipt.blockNumber.toString() }, null, 2),\n        }],\n      };\n    }\n  );\n}\n","export const commerceHubAbi = [\n  {\n    type: \"function\",\n    name: \"createShop\",\n    inputs: [\n      { name: \"name\", type: \"string\" },\n      { name: \"metadataURI\", type: \"string\" },\n    ],\n    outputs: [{ name: \"shop\", type: \"address\" }],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"getShops\",\n    inputs: [],\n    outputs: [{ name: \"\", type: \"address[]\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"isShop\",\n    inputs: [{ name: \"\", type: \"address\" }],\n    outputs: [{ name: \"\", type: \"bool\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"shopCount\",\n    inputs: [],\n    outputs: [{ name: \"\", type: \"uint256\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"protocolFee\",\n    inputs: [],\n    outputs: [{ name: \"\", type: \"uint256\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"event\",\n    name: \"ShopCreated\",\n    inputs: [\n      { name: \"shop\", type: \"address\", indexed: true },\n      { name: \"owner\", type: \"address\", indexed: true },\n      { name: \"name\", type: \"string\", indexed: false },\n    ],\n    anonymous: false,\n  },\n] as const;\n","import { McpServer } from \"@modelcontextprotocol/sdk/server/mcp.js\";\nimport { z } from \"zod\";\nimport { decodeEventLog, formatEther, keccak256, toBytes } from \"viem\";\nimport { identityRegistryAbi } from \"../abis/IdentityRegistry.js\";\nimport { reputationRegistryAbi } from \"../abis/ReputationRegistry.js\";\nimport { validationRegistryAbi } from \"../abis/ValidationRegistry.js\";\nimport { shopAbi } from \"../abis/Shop.js\";\nimport { getPublicClient, getWalletClient, getAccount } from \"../client.js\";\nimport { getConfig } from \"../types.js\";\n\nfunction getRegistryAddresses() {\n  return {\n    identityRegistry: (process.env.COMMERCE_IDENTITY_REGISTRY || \"0x0000000000000000000000000000000000000000\") as `0x${string}`,\n    reputationRegistry: (process.env.COMMERCE_REPUTATION_REGISTRY || \"0x0000000000000000000000000000000000000000\") as `0x${string}`,\n    validationRegistry: (process.env.COMMERCE_VALIDATION_REGISTRY || \"0x0000000000000000000000000000000000000000\") as `0x${string}`,\n  };\n}\n\nexport function registerERC8004Tools(server: McpServer) {\n  server.tool(\n    \"register_agent\",\n    \"Register as an agent in the ERC-8004 Identity Registry\",\n    {\n      agentURI: z.string().describe(\"Agent URI (e.g. IPFS link to registration file)\"),\n    },\n    async ({ agentURI }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n      const { identityRegistry } = getRegistryAddresses();\n\n      const hash = await walletClient.writeContract({\n        address: identityRegistry,\n        abi: identityRegistryAbi,\n        functionName: \"register\",\n        args: [agentURI],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      let agentId: string | undefined;\n      for (const log of receipt.logs) {\n        try {\n          const event = decodeEventLog({ abi: identityRegistryAbi, data: log.data, topics: log.topics });\n          if (event.eventName === \"Registered\") {\n            agentId = (event.args as { agentId: bigint }).agentId.toString();\n          }\n        } catch {}\n      }\n\n      return {\n        content: [{ type: \"text\", text: JSON.stringify({ success: true, txHash: hash, agentId, blockNumber: receipt.blockNumber.toString() }, null, 2) }],\n      };\n    }\n  );\n\n  server.tool(\n    \"get_agent\",\n    \"Get agent details by agentId from the Identity Registry\",\n    {\n      agentId: z.string().describe(\"Agent ID\"),\n    },\n    async ({ agentId }) => {\n      const publicClient = getPublicClient();\n      const { identityRegistry } = getRegistryAddresses();\n\n      const [owner, tokenURI, wallet] = await Promise.all([\n        publicClient.readContract({ address: identityRegistry, abi: identityRegistryAbi, functionName: \"ownerOf\", args: [BigInt(agentId)] }),\n        publicClient.readContract({ address: identityRegistry, abi: identityRegistryAbi, functionName: \"tokenURI\", args: [BigInt(agentId)] }),\n        publicClient.readContract({ address: identityRegistry, abi: identityRegistryAbi, functionName: \"getAgentWallet\", args: [BigInt(agentId)] }),\n      ]);\n\n      return {\n        content: [{ type: \"text\", text: JSON.stringify({ agentId, owner, tokenURI, wallet }, null, 2) }],\n      };\n    }\n  );\n\n  server.tool(\n    \"give_feedback\",\n    \"Leave feedback for an agent via the ERC-8004 Reputation Registry\",\n    {\n      agentId: z.string().describe(\"Agent ID to leave feedback for\"),\n      value: z.number().int().describe(\"Feedback value (e.g. 1-5)\"),\n      valueDecimals: z.number().int().default(0).describe(\"Decimal places for value\"),\n      tag1: z.string().default(\"\").describe(\"Primary tag (e.g. quality, delivery)\"),\n      tag2: z.string().default(\"\").describe(\"Secondary tag\"),\n      feedbackURI: z.string().default(\"\").describe(\"URI to detailed feedback\"),\n    },\n    async ({ agentId, value, valueDecimals, tag1, tag2, feedbackURI }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n      const { reputationRegistry } = getRegistryAddresses();\n\n      const hash = await walletClient.writeContract({\n        address: reputationRegistry,\n        abi: reputationRegistryAbi,\n        functionName: \"giveFeedback\",\n        args: [BigInt(agentId), BigInt(value), valueDecimals, tag1, tag2, \"\", feedbackURI, \"0x0000000000000000000000000000000000000000000000000000000000000000\" as `0x${string}`],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      return {\n        content: [{ type: \"text\", text: JSON.stringify({ success: true, txHash: hash, blockNumber: receipt.blockNumber.toString() }, null, 2) }],\n      };\n    }\n  );\n\n  server.tool(\n    \"get_reputation\",\n    \"Get reputation summary for an agent\",\n    {\n      agentId: z.string().describe(\"Agent ID\"),\n      tag1: z.string().default(\"\").describe(\"Filter by primary tag\"),\n      tag2: z.string().default(\"\").describe(\"Filter by secondary tag\"),\n    },\n    async ({ agentId, tag1, tag2 }) => {\n      const publicClient = getPublicClient();\n      const { reputationRegistry } = getRegistryAddresses();\n\n      const [count, summaryValue, summaryValueDecimals] = await publicClient.readContract({\n        address: reputationRegistry,\n        abi: reputationRegistryAbi,\n        functionName: \"getSummary\",\n        args: [BigInt(agentId), [], tag1, tag2],\n      }) as [bigint, bigint, number];\n\n      const clients = await publicClient.readContract({\n        address: reputationRegistry,\n        abi: reputationRegistryAbi,\n        functionName: \"getClients\",\n        args: [BigInt(agentId)],\n      });\n\n      return {\n        content: [{ type: \"text\", text: JSON.stringify({\n          agentId,\n          feedbackCount: count.toString(),\n          summaryValue: summaryValue.toString(),\n          summaryValueDecimals,\n          uniqueClients: (clients as string[]).length,\n        }, null, 2) }],\n      };\n    }\n  );\n\n  server.tool(\n    \"request_validation\",\n    \"Request validation of an agent's work\",\n    {\n      validatorAddress: z.string().describe(\"Validator's address\"),\n      agentId: z.string().describe(\"Agent ID to validate\"),\n      requestURI: z.string().describe(\"URI to validation request details\"),\n    },\n    async ({ validatorAddress, agentId, requestURI }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n      const { validationRegistry } = getRegistryAddresses();\n\n      const requestHash = keccak256(toBytes(requestURI + Date.now().toString()));\n\n      const hash = await walletClient.writeContract({\n        address: validationRegistry,\n        abi: validationRegistryAbi,\n        functionName: \"validationRequest\",\n        args: [validatorAddress as `0x${string}`, BigInt(agentId), requestURI, requestHash],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      return {\n        content: [{ type: \"text\", text: JSON.stringify({ success: true, txHash: hash, requestHash, blockNumber: receipt.blockNumber.toString() }, null, 2) }],\n      };\n    }\n  );\n\n  server.tool(\n    \"deliver_digital\",\n    \"Deliver digital goods for an order\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      orderId: z.string().describe(\"Order ID\"),\n      payload: z.string().describe(\"Digital delivery payload (hex-encoded or plain text)\"),\n    },\n    async ({ shopAddress, orderId, payload }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n\n      const payloadBytes = toBytes(payload);\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"deliverDigital\",\n        args: [BigInt(orderId), payloadBytes],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      return {\n        content: [{ type: \"text\", text: JSON.stringify({ success: true, txHash: hash, orderId, blockNumber: receipt.blockNumber.toString() }, null, 2) }],\n      };\n    }\n  );\n}\n","export const identityRegistryAbi = [\n  {\n    type: \"function\",\n    name: \"register\",\n    inputs: [{ name: \"agentURI\", type: \"string\" }],\n    outputs: [{ name: \"agentId\", type: \"uint256\" }],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"ownerOf\",\n    inputs: [{ name: \"tokenId\", type: \"uint256\" }],\n    outputs: [{ name: \"\", type: \"address\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"tokenURI\",\n    inputs: [{ name: \"tokenId\", type: \"uint256\" }],\n    outputs: [{ name: \"\", type: \"string\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"setAgentURI\",\n    inputs: [\n      { name: \"agentId\", type: \"uint256\" },\n      { name: \"newURI\", type: \"string\" },\n    ],\n    outputs: [],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"getMetadata\",\n    inputs: [\n      { name: \"agentId\", type: \"uint256\" },\n      { name: \"metadataKey\", type: \"string\" },\n    ],\n    outputs: [{ name: \"\", type: \"bytes\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"getAgentWallet\",\n    inputs: [{ name: \"agentId\", type: \"uint256\" }],\n    outputs: [{ name: \"\", type: \"address\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"event\",\n    name: \"Registered\",\n    inputs: [\n      { name: \"agentId\", type: \"uint256\", indexed: true },\n      { name: \"owner\", type: \"address\", indexed: true },\n      { name: \"agentURI\", type: \"string\", indexed: false },\n    ],\n  },\n] as const;\n","export const reputationRegistryAbi = [\n  {\n    type: \"function\",\n    name: \"giveFeedback\",\n    inputs: [\n      { name: \"agentId\", type: \"uint256\" },\n      { name: \"value\", type: \"int128\" },\n      { name: \"valueDecimals\", type: \"uint8\" },\n      { name: \"tag1\", type: \"string\" },\n      { name: \"tag2\", type: \"string\" },\n      { name: \"endpoint\", type: \"string\" },\n      { name: \"feedbackURI\", type: \"string\" },\n      { name: \"feedbackHash\", type: \"bytes32\" },\n    ],\n    outputs: [],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"getSummary\",\n    inputs: [\n      { name: \"agentId\", type: \"uint256\" },\n      { name: \"clientAddresses\", type: \"address[]\" },\n      { name: \"tag1\", type: \"string\" },\n      { name: \"tag2\", type: \"string\" },\n    ],\n    outputs: [\n      { name: \"count\", type: \"uint256\" },\n      { name: \"summaryValue\", type: \"int256\" },\n      { name: \"summaryValueDecimals\", type: \"uint8\" },\n    ],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"function\",\n    name: \"getClients\",\n    inputs: [{ name: \"agentId\", type: \"uint256\" }],\n    outputs: [{ name: \"\", type: \"address[]\" }],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"event\",\n    name: \"NewFeedback\",\n    inputs: [\n      { name: \"agentId\", type: \"uint256\", indexed: true },\n      { name: \"clientAddress\", type: \"address\", indexed: true },\n      { name: \"feedbackIndex\", type: \"uint64\", indexed: false },\n      { name: \"value\", type: \"int128\", indexed: false },\n      { name: \"valueDecimals\", type: \"uint8\", indexed: false },\n      { name: \"tag1\", type: \"string\", indexed: false },\n      { name: \"tag2\", type: \"string\", indexed: false },\n    ],\n  },\n] as const;\n","export const validationRegistryAbi = [\n  {\n    type: \"function\",\n    name: \"validationRequest\",\n    inputs: [\n      { name: \"validatorAddress\", type: \"address\" },\n      { name: \"agentId\", type: \"uint256\" },\n      { name: \"requestURI\", type: \"string\" },\n      { name: \"requestHash\", type: \"bytes32\" },\n    ],\n    outputs: [],\n    stateMutability: \"nonpayable\",\n  },\n  {\n    type: \"function\",\n    name: \"getValidationStatus\",\n    inputs: [{ name: \"requestHash\", type: \"bytes32\" }],\n    outputs: [\n      { name: \"validatorAddress\", type: \"address\" },\n      { name: \"agentId\", type: \"uint256\" },\n      { name: \"response\", type: \"uint8\" },\n      { name: \"responseHash\", type: \"bytes32\" },\n      { name: \"tag\", type: \"string\" },\n      { name: \"lastUpdate\", type: \"uint256\" },\n    ],\n    stateMutability: \"view\",\n  },\n  {\n    type: \"event\",\n    name: \"ValidationRequested\",\n    inputs: [\n      { name: \"requestHash\", type: \"bytes32\", indexed: true },\n      { name: \"agentId\", type: \"uint256\", indexed: true },\n      { name: \"validatorAddress\", type: \"address\", indexed: true },\n      { name: \"requestURI\", type: \"string\", indexed: false },\n    ],\n  },\n] as const;\n","import { McpServer } from \"@modelcontextprotocol/sdk/server/mcp.js\";\nimport { z } from \"zod\";\nimport { formatEther } from \"viem\";\nimport { shopAbi } from \"../abis/Shop.js\";\nimport { getPublicClient, getWalletClient, getAccount } from \"../client.js\";\n\nconst ORDER_STATUS_LABELS: Record<number, string> = {\n  0: \"Created\",\n  1: \"Paid\",\n  2: \"Fulfilled\",\n  3: \"Completed\",\n  4: \"Cancelled\",\n  5: \"Refunded\",\n};\n\nexport function registerEscrowTools(server: McpServer) {\n  server.tool(\n    \"claim_refund\",\n    \"Claim a refund for an order after the escrow timeout has expired. Only the customer who placed the order can claim.\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      orderId: z.string().describe(\"Order ID to claim refund for\"),\n    },\n    async ({ shopAddress, orderId }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"claimRefund\",\n        args: [BigInt(orderId)],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify({\n              success: true,\n              txHash: hash,\n              orderId,\n              blockNumber: receipt.blockNumber.toString(),\n            }, null, 2),\n          },\n        ],\n      };\n    }\n  );\n\n  server.tool(\n    \"set_escrow_timeout\",\n    \"Set the escrow timeout duration for the shop. Only the shop owner can call this. Minimum is 1 day (86400 seconds).\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      timeoutSeconds: z.number().int().positive().describe(\"Escrow timeout in seconds (minimum 86400 = 1 day)\"),\n    },\n    async ({ shopAddress, timeoutSeconds }) => {\n      const walletClient = getWalletClient();\n      const publicClient = getPublicClient();\n      const account = getAccount();\n\n      const hash = await walletClient.writeContract({\n        address: shopAddress as `0x${string}`,\n        abi: shopAbi,\n        functionName: \"setEscrowTimeout\",\n        args: [BigInt(timeoutSeconds)],\n        account,\n        chain: walletClient.chain,\n      });\n\n      const receipt = await publicClient.waitForTransactionReceipt({ hash });\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify({\n              success: true,\n              txHash: hash,\n              timeoutSeconds,\n              blockNumber: receipt.blockNumber.toString(),\n            }, null, 2),\n          },\n        ],\n      };\n    }\n  );\n\n  server.tool(\n    \"get_escrow_status\",\n    \"Get escrow information for an order, including amount held, order status, timestamps, and whether a refund is currently claimable.\",\n    {\n      shopAddress: z.string().describe(\"Shop contract address\"),\n      orderId: z.string().describe(\"Order ID to check\"),\n    },\n    async ({ shopAddress, orderId }) => {\n      const publicClient = getPublicClient();\n      const addr = shopAddress as `0x${string}`;\n\n      const [order, timeout] = await Promise.all([\n        publicClient.readContract({\n          address: addr,\n          abi: shopAbi,\n          functionName: \"orders\",\n          args: [BigInt(orderId)],\n        }),\n        publicClient.readContract({\n          address: addr,\n          abi: shopAbi,\n          functionName: \"escrowTimeout\",\n        }),\n      ]);\n\n      const [customer, totalAmount, protocolFeeAmount, escrowAmount, status, createdAt, shippingHash] = order as [\n        string, bigint, bigint, bigint, number, bigint, string\n      ];\n\n      const escrowTimeoutSeconds = timeout as bigint;\n      const now = BigInt(Math.floor(Date.now() / 1000));\n      const expiresAt = createdAt + escrowTimeoutSeconds;\n      const isRefundClaimable = status === 1 && now >= expiresAt && escrowAmount > 0n;\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify({\n              orderId,\n              customer,\n              totalAmount: formatEther(totalAmount) + \" ETH\",\n              escrowAmount: formatEther(escrowAmount) + \" ETH\",\n              protocolFeeAmount: formatEther(protocolFeeAmount) + \" ETH\",\n              status: ORDER_STATUS_LABELS[status] ?? `Unknown(${status})`,\n              statusCode: status,\n              createdAt: createdAt.toString(),\n              escrowTimeoutSeconds: escrowTimeoutSeconds.toString(),\n              expiresAt: expiresAt.toString(),\n              isRefundClaimable,\n            }, null, 2),\n          },\n        ],\n      };\n    }\n  );\n}\n"],"mappings":"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","names":["server","query","z","server","z","z","decodeEventLog","parseEther","server","z","decodeEventLog","parseEther","z","decodeEventLog","server","z","decodeEventLog","z","formatEther","server","z","formatEther"]}